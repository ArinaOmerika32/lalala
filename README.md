p = 43 j = 3
a = 57 b = 179
k1 = j^a mod p
k2 = j^b mod p
k = 3^57 mod 43
k = 3^179 mod 43
22 30
key = 30^57 mod 43
key = 22^179 mod 43
8 8

Человек посередине
Диффи-Хеллман не проверяет личность участников. Злоумышленник может: Перехватить открытые ключи Алисы и Боба, подменить их своими ключами, создать два общих секрета: один с Алисой, другой с Бобом.
Результат: Алиса и Боб думают, что общаются напрямую, но все сообщения проходят через злоумышленника.

Почему Диффи-Хеллман работает
1. Общие параметры: большое простое число p и генератор g
2. Секреты: Алиса имеет a, Боб имеет b
3. Обмен: Алиса → Бобу: A = g^a mod p, Боб → Алисе: B = g^b mod p
4. Общий секрет:
   · Алиса вычисляет: B^a mod p = (g^b)^a = g^(ba)
   · Боб вычисляет: A^b mod p = (g^a)^b = g^(ab)
Почему равны: g^(ab) = g^(ba) благодаря коммутативности умножения.
